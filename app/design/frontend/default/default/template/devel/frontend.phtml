<!-- 
	To ensure the JS and CSS files only get loaded when Devel
	is allowed to run, we've moved them from the frontend.xml file
	to here.
	@todo At some point, we should move them somewhere else, in
	order to get them out of the template.
 -->

<script type="text/javascript" src="<?php echo Mage::getBaseUrl() ?>js/devel/data.js"></script>
<script type="text/javascript" src="<?php echo Mage::getBaseUrl() ?>js/devel/helpers.js"></script>
<script type="text/javascript" src="<?php echo Mage::getBaseUrl() ?>js/devel/toolbar.js"></script>
<script type="text/javascript" src="<?php echo Mage::getBaseUrl() ?>js/devel/panels.js"></script>
<script type="text/javascript" src="<?php echo Mage::getBaseUrl() ?>js/devel/hints.js"></script>
<script type="text/javascript" src="<?php echo Mage::getBaseUrl() ?>js/devel/sprites.js"></script>

<style>
/*@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/styles-ie.css);*/
@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/data.css);
@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/animations.css);
@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/krumo.css);
@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/toolbar.css);
@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/panels.css);
@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/hints.css);
@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/sprites.css);
@import url(<?php echo Mage::getBaseUrl() ?>skin/frontend/default/default/devel/css/forms.css);
</style>	

<!-- 
	Main block
 -->
<div id="dhmedia_devel_block_frontend">
	
	<a
		class="dhlink"
		target="_blank"
		title="Doghouse Media - Perth based web agency and Magento specialists"
		href="http://www.dhmedia.com.au/?ref=magento-toolbar">
		<span>by </span>
		Doghouse Media
	</a>
	
	<div class="update-notifier-box has-sprite sprite-small icon-important"></div>
	
	<?php echo $this->getChildHtml('menu') ?>
	
	<div class="clear-fix"></div>
	
	<div class="devel-data" rel="layoutXml" title="Xml">
<!--
	You can't tab or space the following textarea without 
	creating problems with the editor. Putting in all on
	one line works too.
 -->
<textarea id="layout-xml" name="layout-xml" class="devel-editor">
<?php echo '<?xml version="1.0" encoding="UTF-8"?>' . "\n" ?>
<?php echo $this->getLayoutXml() ?>
</textarea>
	</div>
	
</div>

<!-- 
	Panel
 -->
<div id="dhmedia_devel_block_panels">
	
	<!--  These blocks are only here for reference. Remove when panel refactoring is done. -->
	
	<div id="dhmedia_devel_block_panel_editor" class="devel-panel" title="Editor"
		data-button-class="sprite-small icon-editor">
		<iframe id="devel-editor" 
			src="<?php echo $this->helper('devel/url')->getHelpUrl('panels/editor/usage') ?>">
		</iframe>
	</div>
	
	<div id="dhmedia_devel_block_panel_block" class="devel-panel" title="Block" 
		data-button-class="sprite-small icon-blocks">
		<iframe id="devel-block"
			src="<?php echo $this->helper('devel/url')->getHelpUrl('panels/block/usage') ?>">
		</iframe>
	</div>
</div>

<script type="text/javascript">

document.observe("dom:loaded", function()
{
	new DevelForms('#dhmedia_devel_block_frontend form');

	DevelGlobals.DevelHints = new DevelHints('.devel-hint', '.devel-hint .hints');
	
	DevelGlobals.PanelManager = new DevelPanelManager('#dhmedia_devel_block_panels', {
		container: {
			css: {
				marginLeft: '-1ex'
			}
		}
	});

	new DevelUpdateNotifier('#dhmedia_devel_block_frontend .update-notifier-box',
		'<?php echo $this->helper('devel/url')->getUrl('self/hasupdate') ?>'
	);

	new DevelSprites('.has-sprite');

	DevelGlobals.DevelData = new DevelData('#dhmedia_devel_block_frontend .devel-data');
	DevelGlobals.Data = DevelGlobals.DevelData.getData();
});

var DevelGlobals = {};
	
</script>

<!--  START Code Mirror editor -->
<style>
	@import url("<?php echo Mage::getBaseUrl('js') ?>codemirror/lib/codemirror.css"); 
	@import url("<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/xml/xml.css");
	@import url("<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/javascript/javascript.css"); 
	@import url("<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/css/css.css");
	@import url("<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/clike/clike.css");

	.CodeMirror { height: auto; }
	#dhmedia_devel_block_panel_xml .CodeMirror { height: 100%; }
</style>
	
<script type="text/javascript" src="<?php echo Mage::getBaseUrl('js') ?>codemirror/lib/codemirror.js"></script> 
<script type="text/javascript" src="<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/xml/xml.js"></script>
<script type="text/javascript" src="<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/javascript/javascript.js"></script> 
<script type="text/javascript" src="<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/css/css.js"></script>
<script type="text/javascript" src="<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/clike/clike.js"></script>
<script type="text/javascript" src="<?php echo Mage::getBaseUrl('js') ?>codemirror/mode/php/php.js"></script>

<script type="text/javascript">
CodeMirror.fromTextArea(document.getElementById("layout-xml"), {
    lineNumbers: true,
    matchBrackets: true,
    mode: "application/xml",
    indentUnit: 8,
    indentWithTabs: true,
    enterMode: "keep",
    tabMode: "shift",
    readOnly: true
});
</script>
<!--  END Code Mirror editor -->